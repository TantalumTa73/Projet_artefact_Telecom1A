<!DOCTYPE html>
<html lang="en">

<script> 
  function changeImage(element)
  {
    //var x = element.getElementsById("image_camera");
    var x = element;
    x.setAttribute("src", {{url_for('static', filename='image.png?nocache=' + Math.random())}});	
  }
  </script>

<head>
    <meta charset="UTF-8">
    <title>Strawberrypi!</title>
</head>
<body>
<h1><i> Welcome to the raspberry page!</i></h1>
    <form method="POST" action ="">
	<button type="submit" formaction="" name="button" value="1">Avancer les moteurs</button>
	<button type="submit" formaction="" name="button" value="2">Arrêter les moteurs</button>
  </form>

<form method="POST">
  <div class="rangeslider">
	<input type="range" min="-127" max="127" value="0" class="slider" id="sliderRange">
  </div>
</form>

<form action="/test_calibrage" method="POST">
    <label for="text">Moteur principal:</label>
    <input type="text" id="text" name="text" required><br><br>
    <label for="num2">Ratio:</label>
    <input type="number" id="num2" step="any" name="num2" required><br><br>
    <button type="submit">Test avance corigée</button>
</form>


<button id="forward">Avancer</button>
<button id="backward">Reculer</button>
<button id="right">Droite</button>
<button id="left">Gauche</button>

<script>
    // The URL for the POST requests
    const urlForward = '/forward-press';  // URL to send when the button is pressed
    const urlBackward= '/backward-press';  // URL to send when the button is pressed
    const urlRight = '/right-press';  // URL to send when the button is pressed
    const urlLeft = '/left-press';  // URL to send when the button is pressed
    const urlRelease = '/button-release'; // URL to send when the button is released

    // Function to send a POST request
    function sendPostRequest(url) {
        fetch(url, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({ action: 'button-activated' })
        })
        .then(response => response.json());
    }

    const buttonForward = document.getElementById('forward');
    const buttonBackward = document.getElementById('backward');
    const buttonRight = document.getElementById('right');
    const buttonLeft = document.getElementById('left');

    // When the button is pressed
    buttonForward.addEventListener('mousedown', function() {
        sendPostRequest(urlForward);  // Send POST request when pressed
    });
    buttonBackward.addEventListener('mousedown', function() {
        sendPostRequest(urlBackward);  // Send POST request when pressed
    });
    buttonRight.addEventListener('mousedown', function() {
        sendPostRequest(urlRight);  // Send POST request when pressed
    });
    buttonLeft.addEventListener('mousedown', function() {
        sendPostRequest(urlLeft);  // Send POST request when pressed
    });

    // When the button is released
    buttonForward.addEventListener('mouseup', function() {
        sendPostRequest(urlRelease);  // Send a different POST request when released
    });
    buttonBackward.addEventListener('mouseup', function() {
        sendPostRequest(urlRelease);  // Send a different POST request when released
    });
    buttonRight.addEventListener('mouseup', function() {
        sendPostRequest(urlRelease);  // Send a different POST request when released
    });
    buttonLeft.addEventListener('mouseup', function() {
        sendPostRequest(urlRelease);  // Send a different POST request when released
    });

</script>

<span id="time"></span>

<img
  id = "image_camera"
  src="{{url_for('static', filename='image.png')}}"
  alt="Ici doit se trouver l'image capturée par la caméra" 
  onclick="changeImage(this);"/>

  <form name="alternate" method="POST" action="">
    <input type="button" value="Change" onclick="changeImage(document.getElementById("image_camera");">
 </form>




<script type="text/javascript" src="http://code.jquery.com/jquery-1.8.0.min.js"></script>



<script type="text/javascript">
function updater() {
  $.get('/update', function(data) {
    $('#time').html(data);  // update page with new data
  });
};

setInterval(updater, 1000);  // run `updater()` every 1000ms (1s)
</script>

<script> 
    const Http = new XMLHttpRequest();
    var rangeslider = document.getElementById("sliderRange"); 
    var current;
		
    rangeslider.oninput = function() {
	current = this.value;
	
	Http.open('POST', 'slider', true);
	Http.setRequestHeader('content-type', 'application/x-www-form-urlencoded;charset=UTF-8');
	Http.send("valeur=" + current)
    }
</script>
</form>
</body>
</html>
