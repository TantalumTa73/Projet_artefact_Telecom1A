<!DOCTYPE html>
<html lang="en">


<div style="width: 100%;">
	<div style="width: 50%; height: 100px; float: left;"> 

		<head>
			<meta charset="UTF-8">
			<title>Strawberrypi!</title>
		</head>
		<body>
		<h1><i> Welcome to the strawberrypi webpage!</i></h1>

		<form action="/toggle-image-view" method="POST">
			<button type="submit">Arrêter / Continuer flux image</button>
		</form>

		<form action="/init_position" method="POST">
			<label for="x">Case initial x:</label>
			<input type="text" id="x" step="any" name="x" required>
			<label for="y">Case initial y:</label>
			<input type="text" id="y" step="any" name="y" required>
			<button type="submit">Envoyer position initial</button>
		</form>
		
		<form action="/go_to" method="POST">
			<label for="x">Position x:</label>
			<input type="number" id="x" step="any" name="x" required>
			<label for="y">Position y:</label>
			<input type="number" id="y" step="any" name="y" required>
			<button type="submit">Envoyer position</button>
		</form>

		<form action="/test_calibrage" method="POST">
			<label for="text">Moteur principal:</label>
			<input type="text" id="text" name="text" required><br><br>
			<label for="ratio">Ratio:</label>
			<input type="number" id="ratio" step="any" name="num2" required><br><br>
			<button type="submit">Test avance corigée</button>
		</form>

		<form action="/change-speed" method="POST">
			<label for="speed">Vitesse (entière): </label>
			<input type="number" id="speed" name="speed" required><br><br>
			<button type="submit">Change vitesse</button>
		</form>

		<form action="/avance-test" method="POST">
			<button type="submit">Test avance</button>
		</form>

		<button id="forward">Avancer</button>
		<button id="backward">Reculer</button>
		<button id="left">Gauche</button>
		<button id="right">Droite</button>

		<span id="time"></span>

	</div>

	<div style="margin-left: 50%; height: 100px"> 
		<img
		  id = "image_camera"
		  src="{{url_for('static', filename='image.png')}}"
		  alt="Ici doit se trouver l'image capturée par la caméra" 
		  onclick="this.setAttribute('src', '{{url_for('static', filename='image.png')}}?nocache=' + Math.random());"/>
	</div>
</div>

<script type="text/javascript" src="http://code.jquery.com/jquery-1.8.0.min.js"></script>

<script> // Live control for robot
	// Key press event
	document.addEventListener('keydown', function(event) {
		if (event.key === "ArrowUp") {
			// Send a POST request to the Flask server to trigger the forward press function
			fetch('/forward-press', {
				method: 'POST',
			});
		}
		else if (event.key === "ArrowDown") {
			// Send a POST request to the Flask server to trigger the downward press function
			fetch('/downward-press', {
				method: 'POST',
			});
		}
		if (event.key === "ArrowLeft") {
			// Send a POST request to the Flask server to trigger the left press function
			fetch('/left-press', {
				method: 'POST',
			});
		}
		if (event.key === "ArrowRight") {
			// Send a POST request to the Flask server to trigger the right press function
			fetch('/right-press', {
				method: 'POST',
			});
		}
	});

	// Key release event
	document.addEventListener('keyup', function(event) {
		if (event.key === "ArrowUp") {
			// Send a POST request to the Flask server to trigger the forward release function
			fetch('/forward-release', {
				method: 'POST',
			});
		}
		else if (event.key === "ArrowDown") {
			// Send a POST request to the Flask server to trigger the downward release function
			fetch('/downward-release', {
				method: 'POST',
			});
		}
		if (event.key === "ArrowLeft") {
			// Send a POST request to the Flask server to trigger the left release function
			fetch('/left-release', {
				method: 'POST',
			});
		}
		if (event.key === "ArrowRight") {
			// Send a POST request to the Flask server to trigger the right release function
			fetch('/right-release', {
				method: 'POST',
			});
		}
        });
</script>

<script type="text/javascript">
	function updater() {
		$.get('/update', function(data) {
			$('#time').html(data);  // update page with new data
			document.getElementById('image_camera').setAttribute('src', '{{url_for('static', filename='image.png')}}?nocache=' + Math.random());
		});
	};

	setInterval(updater, 1000);  // run `updater()` every 1000ms (1s)
</script>

</body>
</html>
